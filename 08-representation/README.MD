## 表示 (Representation)

机器学习模型不能直接看到、听到或感知输入样本。您必须创建数据表示，为模型提供有用的信号来了解数据的关键特性。也就是说，为了训练模型，您必须选择最能代表数据的特征集。

预计用时：9 分钟

### 学习目标

- 将日志和 Protocol Buffer 中的字段映射到实用的机器学习特征。
- 判断哪些特性可用作合适的特征。
- 处理离群值特征。
- 调查数据集的统计属性。
- 使用 tf.estimator 训练并评估模型。

### 表示 (Representation)：特征工程

传统编程的关注点是代码。在机器学习项目中，关注点变成了表示。也就是说，开发者通过添加和改善特征来调整模型。

将原始数据映射到特征
图 1 左侧表示来自输入数据源的原始数据，右侧表示**特征矢量**，也就是组成数据集中样本的浮点值集。 **特征工程**指的是将原始数据转换为特征矢量。进行特征工程预计需要大量时间。

机器学习模型通常期望样本表示为实数矢量。这种矢量的构建方法如下：为每个字段衍生特征，然后将它们全部连接到一起。

![feature][p-fea-1]

**图 1. 特征工程将原始数据映射到机器学习特征。**

#### 映射数值

机器学习模型根据浮点值进行训练，因此整数和浮点原始数据不需要特殊编码。正如图 2 所示，将原始整数值 6 转换为特征值 6.0 是没有意义的：

![feature][p-fea-2]

**图 2. 将整数值映射到浮点值。**

#### 映射字符串值

模型无法通过字符串值学习规律，因此您需要进行一些特征工程来将这些值转换为数字形式：

1. 首先，为您要表示的所有特征的字符串值定义一个**词汇表**。对于 `street_name` 特征，该词汇表中将包含您知道的所有街道。
    > 注意：所有其他街道都可以归入一个笼统的“其他”类别，该类别称为 OOV（未收录到词汇表中）桶。
2. 然后，使用该词汇表创建一个**one-hot编码**，用于将指定字符串值表示为二元矢量。在该矢量（与指定的字符串值对应）中：
    - 只有一个元素设为 1。
    - 其他所有元素均设为 0。

该矢量的长度等于词汇表中的元素数。

图 3 显示了某条特定街道 (Shorebird Way) 的one-hot编码。在此二元矢量中，代表 Shorebird Way 的元素的值为 1，而代表所有其他街道的元素的值为 0。

![feature][p-fea-3]

**图 3. 通过one-hot编码映射字符串值。**

#### 映射分类（枚举）值

分类特征具有一组离散的可能值。例如，名为 Lowland Countries 的特征只包含 3 个可能值：

```
  {'Netherlands', 'Belgium', 'Luxembourg'}
```

您可能会将分类特征（如 Lowland Countries）编码为枚举类型或表示不同值的整数离散集。例如：

将荷兰表示为 0
将比利时表示为 1
将卢森堡表示为 2
不过，机器学习模型通常将每个分类特征表示为单独的布尔值。例如，Lowland Countries 在模型中可以表示为 3 个单独的布尔值特征：

x1：是荷兰吗？
x2：是比利时吗？
x3：是卢森堡吗？
采用这种方法编码还可以简化某个值可能属于多个分类这种情况（例如，“与法国接壤”对于比利时和卢森堡来说都是 True）。

### 更多

- [Qualities of good features](A-qualities-of-good-features.md)
- [Cleaning data](B-cleaning-data.md)

[p-fea-1]: ../image/08-A-feature-1.png
[p-fea-2]: ../image/08-A-feature-2.png
[p-fea-3]: ../image/08-A-feature-3.png